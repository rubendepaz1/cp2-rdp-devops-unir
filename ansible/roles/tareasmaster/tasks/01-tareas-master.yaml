---
  
   - name: Abriendo puertos para K8s 
     firewalld: 
       port: "{{ item }}"
       permanent: true
       state: enabled
     loop:
      - 6443/tcp
      - 2379-2380/tcp
      - 10250-10252/tcp
      - 10255/tcp

   - name: Configurando Kubeadmin
     become: yes
     command: kubeadm config images pull

   - name: Permitiendo acceso desde el worker 
     firewalld: 
       rich_rule: "{{ item }}"
       permanent: true
       state: enabled
     loop:
      - 'rule family=ipv4 source address=10.0.1.10/32 accept'
      - 'rule family=ipv4 source address=10.0.1.11/32 accept'

# reloaded mejor que restarted para que recargue la configuraci√≥n
   - name: Reload Firewall 
     service:
       name: firewalld
       state: reloaded
       enabled: yes

   - name: CNI y red PODs
     become: yes
     command: kubeadm init --pod-network-cidr 192.169.0.0/16
     register: kubeadminit